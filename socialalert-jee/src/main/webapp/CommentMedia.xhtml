<ui:composition template="/WEB-INF/templates/MasterTemplate.xhtml" 
	xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"> 
<ui:define name="content">
<p:importConstants type="com.bravson.socialalert.business.media.MediaConstants" var="MediaConstants" />
<f:metadata>
    	<f:viewParam name="uri" value="#{mediaCommentView.mediaUri}" id="uri" />
    	<f:event listener="#{mediaCommentView.startConversation()}" type="preRenderView"></f:event>
</f:metadata>
<h:form>
	<p:growl id="messages" showDetail="true" sticky="false" life="2000" />
	<h:inputHidden value="#{mediaCommentView.mediaUri}" id="uri" />
	<p:panel header="Comments">
		<p:inputTextarea value="#{mediaCommentView.comment}" rows="5" cols="30" counter="commentLength" maxlength="200" counterTemplate="{0} characters remaining." style="width:100%" required="true" requiredMessage="Comment cannot be empty" />
		<h:panelGroup class="ui-g">
			<div class="ui-g-1"><p:commandButton value="Post" action="#{mediaCommentView.postComment()}" ajax="false"></p:commandButton></div>
			<div class="ui-g-1"><span></span></div>
			<div class="ui-g-10"><h:outputText id="commentLength" /></div>
		</h:panelGroup>
		<p:dataScroller value="#{mediaCommentView.commentList}" var="item" chunkSize="10" lazy="true" styleClass="comment">
			<h:panelGrid>
				<h:panelGroup class="ui-g">
					<div class="ui-g-6"><h:outputText styleClass="#{item.creator.online ? 'online' : 'offline'}" value="#{item.creator.username}" /></div>
					<div class="ui-g-6"><h:outputText value="#{item.creation}" converter="#{prettyInstantConverter}"/></div>
				</h:panelGroup>
				<h:panelGroup styleClass="preformatted">#{item.comment}</h:panelGroup>
				<h:panelGroup class="ui-g">
					<div class="ui-g-3"><span class="fa fa-thumbs-o-up"/><span> #{item.likeCount} </span></div>
	                <div class="ui-g-3"><span class="fa fa-thumbs-o-down"/><span> #{item.dislikeCount} </span></div>
	                <div class="ui-g-3">REPORT</div>
				</h:panelGroup>
			</h:panelGrid>
			<f:facet name="loader">
				<p:commandButton type="button" value="More" icon="ui-icon-circle-triangle-s"/>
			</f:facet>
		</p:dataScroller>
	</p:panel>
</h:form>
</ui:define>
</ui:composition>