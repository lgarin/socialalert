<ui:composition template="/WEB-INF/templates/MasterTemplate.xhtml" 
	xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui">
<ui:define name="content">
	<f:metadata>
		<f:event listener="#{userSession.init(request.userPrincipal.keycloakSecurityContext.tokenString)}" type="preRenderView"></f:event>
		<f:viewAction action="#{indexView.loadMediaList()}" />
	</f:metadata>
	<h:form>
	<p:growl id="messages" showDetail="true" sticky="false" life="2000" />  
	<h1>Hello #{userSession.userInfo.username}, your IP is #{userSession.userAccess.ipAddress}.</h1>
	<ui:include src="/WEB-INF/templates/MediaSearch.xhtml">
		<ui:param name="searchAction" value="#{indexView.loadMediaList()}" />
	</ui:include>
	<p:dataGrid var="media" value="#{indexView.mediaList}" columns="5" rows="4" layout="grid" styleClass="ui-datagrid-no-border">
		<ui:include src="/WEB-INF/templates/MediaThumbnail.xhtml">
			<ui:param name="media" value="#{media}" />
		</ui:include>
	</p:dataGrid>
	</h:form>
</ui:define>
</ui:composition> 
